<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, userr-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"/>
        <link rel="stylesheet" href="../static/layui/css/layui.css"/>
    <title>administrator</title>
</head>
<style>
body{
            margin:0px;
            background: #f4f4f4;
            height:100%; 
            overflow-y: scroll;
            min-height:100%;
            box-sizing:border-box;
            padding-bottom: 180px;
            min-width: 1000px;
            position: relative!important;
            display: block;
        }
        header{
            width:100%;
            min-width: 1000px;
            box-shadow: 0 1px 0 0 #ddd;
            height:80px;
            background:#fff;
            margin-bottom: 40px;
        }
        header .top{
            width:1000px;
            margin:0 auto;
            background:url(../static/logo.jpg) no-repeat;
            background-size: 100px 80px;
        }
        header .top h1{
            display:inline-block;
            margin-left:120px;
            line-height: 80px;
        }
        header .top button{
            margin-left:450px;
            margin-top:-10px;
        }
        section{
            
            width:100%;
            margin:0 auto;    
            min-height:600px;
            display:block;
            margin-bottom:30px;           
        }
        section div.container{
            background:#fff;
            width:1000px;
            margin:0 auto
        }
        footer{
            padding-top: 40px;
            height: 100px;
            box-sizing: border-box;
            text-align: center;
            position: absolute;
            bottom: 0;
            width: 100%;
            left: 0;
            background: #444547;
            font-size: 12px;
            min-height: 28px;
            
        }
        footer p{
            color: #777;
            line-height: 24px;
        }
</style>
<body>
		<header>
				<div class="top">
					<h1>华为 实习生管理信息系统</h1>
					
					<button class="layui-btn" id="sign_out">退出</button>
				</div>
			</header>
	<section>
	<div class="layui-fluid container" id="LAY-app-message" >
			<div class="layui-card" style="padding: 5px;">
				<!-- 三个选项卡 -->
				<div class="layui-tab" lay-filter="tab">
						<ul class="layui-tab-title">
						  <li class="layui-this" lay-id="hr">hr信息</li>
						  <li lay-id="teacher">导师信息</li>
						  <li lay-id="student">实习生信息</li>

						</ul>
						<div class="layui-tab-content">
							<div class="layui-tab-item  layui-show">
									<div class="layui-row">
											<div class="layui-inline">
												<button class="layui-btn" data-type="getCheckData" isMaximize="0"
													id="addHr" topHeight="600px">
													<i class="layui-icon">&#xe654;</i>新增</button>
												<button class="layui-btn layui-btn-danger" id="deleteHr"
													isMutiDml="1" isConfirm="1">
													<i class="layui-icon">&#xe640;</i>批量删除</button>
												<a href="javascript:;" layadmin-event="refresh" title="刷新">
													<button class="layui-btn" id="refreshHr">
														<i class="layui-icon">&#x1002;</i>刷新</button>
												</a>
											</div>
										</div>
								<table class="layui-hide" id="hrTable"
								lay-filter="hrTable"></table>
							</div>
							<div class="layui-tab-item">
									<div class="layui-row">
											<div class="layui-inline">
												<button class="layui-btn" data-type="getCheckData" isMaximize="0"
													id="addTeacher" topHeight="600px">
													<i class="layui-icon">&#xe654;</i>新增</button>
												<button class="layui-btn layui-btn-danger" id="delete"
													isMutiDml="1" isConfirm="1">
													<i class="layui-icon">&#xe640;</i>批量删除</button>
												<a href="javascript:;" layadmin-event="refresh" title="刷新">
													<button class="layui-btn" id="refresh">
														<i class="layui-icon">&#x1002;</i>刷新</button>
												</a>
											</div>
										</div>
								<table class="layui-hide" id="teacherTable"
								lay-filter="teacherTable"></table>
							</div>
							<div class="layui-tab-item">
								<div class="layui-row">
									<form id="inlineForm" class="layui-form">
										<fieldset class="layui-elem-field">
											<legend>搜索</legend>
											<div class="layui-field-box">
												<div class="demoTable">
													名称：
													<div class="layui-inline">
														<input class="layui-input" name="title" placeholder="输入姓名或工号" autocomplete="off" id="title"/>
													</div>
													<button class="layui-btn" lay-filter="search" lay-submit="lay-submit">
														<i class="layui-icon">&#xe615;</i>搜索</button>
													<button type="button" class="layui-btn" id="input">上传</button>
												</div>
											</div>
										</fieldset>
									</form>
									</div>
									<div class="layui-row">
											<div class="layui-inline">
												<button class="layui-btn" data-type="getCheckData" isMaximize="0"
													id="addStudent" topHeight="600px">
													<i class="layui-icon">&#xe654;</i>新增</button>
												<button class="layui-btn layui-btn-danger" id="delete"
													isMutiDml="1" isConfirm="1">
													<i class="layui-icon">&#xe640;</i>批量删除</button>
												<a href="javascript:;" layadmin-event="refresh" title="刷新">
													<button class="layui-btn" id="refresh">
														<i class="layui-icon">&#x1002;</i>刷新</button>
												</a>
											</div>
										</div>
									<table class="layui-hide" id="studentTable"
									lay-filter="studentTable"></table>
							</div>

						
						  
						</div>
					  </div>

			<script type="text/html" id="optsbar">
				<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>
				<a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
				<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
			</script>
		
			
				
			
		
			</div>
		</div>
	</section>
	<footer>
			<p>
				Copyright
			</p>
	</footer>
<script src="../static/layui/layui.js"></script>
<script type="text/javascript">

	layui.use([ 'table', 'form', 'element', 'jquery' ,'upload'],
			function() {
						window.jQuery = window.$ = layui.jquery;
						var table = layui.table
						,layer = layui.layer
						,form = layui.form
						,element = layui.element
						,upload = layui.upload;
					//方法级渲染   hr列表
					table.render({
							elem : '#hrTable',
							url : '/hr/select', //数据接口
							cols : [ [ {
								checkbox : true,
								fixed : true
							}, {
								field : 'name',
								width : 100,
								title : 'hr姓名'
							},  {
								field : 'job_number',
								width : 200,
								title : 'hr工号',
								
							}, {
								field : 'first_dept',
								title : '所在一级部门',
								width : 200,
								sort : true,
							
							},
							{
								field : 'second_dept',
								title : '所在二级部门',
								width : 200,
								sort : true,
							
							},
							{
								fixed : 'right',
								minWidth : 200,
								align : 'center',
								toolbar : '#optsbar'
							} ] ],
							page : true,
							limits : [ 15, 20, 30, 50, 100, 500 ],
							limit : 15 //默认采用60
							,
							response : {
								statusName : 'error',
								statusCode : 0,
								msgName : 'message',
								countName : 'count'
							}
						});
						//hr新增
						$('#addHr').on('click', function() {
							layer.open({
								type : 2,
								area : [ '700px', '450px' ],
								fixed : false, //不固定
								maxmin : true,
								content : '../templates/administrator/admin_addHr.html',
								end : function() {
									layui.index.render();
								}
							});
						});
						//hr批量删除
						$('#deleteHr').on('click',function() {
							var checkStatus = table.checkStatus('hrTable'), data = checkStatus.data;
							var id = "";
							for ( var d in data) {
								id = id + data[d].id + ",";
							}
							if (id == "") {
								layer.msg("最少选择一个进行删除！");
							} else {
								//向服务端发送删除指令
								$.ajax({
									url : '/hr/batchDelete?id='+ id  ,//接口
									type : 'get',
									dataType : 'JSON',
									success : function(data) {
										layer.msg(data.msg);
										layui.index.render();
									},
									error : function(e) {
										layer.msg("服务器繁忙！操作失败，清重试！")
									}
								
								});
							}
						});
	
					//方法级渲染   导师列表
					table.render({
							elem : '#teacherTable',
							url : '/teacher/select', //数据接口
							cols : [ [ {
								checkbox : true,
								fixed : true
							}, {
								field : 'name',
								width :100,
								title : '导师姓名'
							},  {
								field : 'job_number',
								width : 200,
								title : '导师工号',
								
							}, {
								field : 'first_dept',
								title : '所在一级部门',
								width : 200,
								sort : true,
							
							}, 
							{
								field : 'second_dept',
								title : '所在二级部门',
								width : 200,
								sort : true,
							
							},
							{
								fixed : 'right',
								minWidth : 200,
								align : 'center',
								toolbar : '#optsbar'
							} ] ],
							page : true,
							limits : [ 15, 20, 30, 50, 100, 500 ],
							limit : 15 //默认采用60
							,
							response : {
								statusName : 'error',
								statusCode : 0,
								msgName : 'message',
								countName : 'count'
							}
						});
						//导师新增
						$('#addTeacher').on('click', function() {
							layer.open({
								type : 2,
								area : [ '700px', '450px' ],
								fixed : false, //不固定
								maxmin : true,
								content : '../templates/administrator/admin_addTeacher.html',
								end : function() {
									layui.index.render();
								}
							});
						});

						//方法级渲染   学生列表
						table.render({
							elem : '#studentTable',
							url : '/stuinfo/selectByAdmin', //数据接口
							where:{}
							,cols : [ [ {
								checkbox : true,
								fixed : true
							}, {
								field : 'name',
								minWidth : 80,
								title : '学生姓名'
							},  {
								field : 'job_number',
								minWidth : 80,
								title : '学生工号',
								
							}, {
								field : 'phone_number',
								title : '联系方式',
								width : 100,
								sort : true,
							
							}, {
								fixed : 'right',
								minWidth : 200,
								align : 'center',
								toolbar : '#optsbar'
							} ] ],
							page : true,
							limits : [ 15, 20, 30, 50, 100, 500 ],
							limit : 15 //默认采用60
							,
							response : {
								statusName : 'error',
								statusCode : 0,
								msgName : 'message',
								countName : 'count'
							}
						});
						//实习生新增
						$('#addStudent').on('click', function() {
							layer.open({
								type : 2,
								area : [ '700px', '450px' ],
								fixed : false, //不固定
								maxmin : true,
								content : '../templates/administrator/admin_addStudent.html',
								end : function() {
									layui.index.render();
								}
							});
						});
						//搜索功能
						form.on('submit(search)', function(data) {
							var key=$("#title").val();
							table.reload('studentTable', {where :{key:key},page:{curr:1}});
							return false;
						});

						table.on('tool(studentTable)', function(obj) { //注：tool是工具条事件名，test是table原始容器的属性 lay-filter="对应的值"
							var data = obj.data //获得当前行数据
							, layEvent = obj.event; //获得 lay-event 对应的值
							if (layEvent === 'detail') {
								layer.open({
									type : 2,
									area : [ '700px', '450px' ],
									fixed : false, //不固定
									maxmin : true,
									content : ''
								});
							} else if (layEvent === 'del') {
								layer.confirm('真的删除行么', function(index) {
									// obj.del(); //删除对应行（tr）的DOM结构
									layer.close(index);
									$.ajax({
										url : '',
										type : 'get',
										dataType : 'JSON',
										success : function(data) {
											layer.msg(data.msg);
											layui.index.render();

										},
										error : function(e) {
											layer.msg("服务器繁忙！操作失败，清重试！")
										}
									//向服务端发送删除指令
									});
								});
							} else if (layEvent === 'edit') {
								layer.open({
									type : 2,
									area : [ '700px', '450px' ],
									fixed : false, //不固定
									maxmin : true,
									content : '',
									end : function() {
										layui.index.render();
									}
								});
							}
						});

						$('delete').on('click',function() {
								var checkStatus = table.checkStatus('listTable'), data = checkStatus.data;
								var id = "";
								for ( var d in data) {
								     id = id + data[d].id + ",";
								}
								if (id == "") {
								   layer.msg("最少选择一个进行删除！");
								} else {
									     $.ajax({url : '',
												dataType : 'JSON',
												success : function(data) {
													layer.msg(data.msg);
													layui.index.render();
													},
													error : function(e) {
														layer.msg("服务器繁忙！操作失败，清重试！")
													}
								//向服务端发送删除指令
										});
								}
						});
						$('#add').on('click', function() {
							layer.open({
								type : 2,
								area : [ '700px', '450px' ],
								fixed : false, //不固定
								maxmin : true,
								content : '',
								end : function() {
									layui.index.render();
								}
							});
						});

						//导入
						upload.render({
							elem : '#input',//绑定元素
							url : '/excel/upload',//上传接口
							accept : 'file',
							done : function(res) {
								//上传完毕回调
								layer.msg("成功插入" + res + "条数据！");
								table.reload('hrTable');
								table.reload('teacherTable');
								table.reload('studentTable');

							},
							error : function() {
								//请求异常回调
								window.alert("文件导入失败！系统异常，请重试！");
							}
						})
						 //退出按钮功能
						 $('#sign_out').click(function(){
                                window.open('../templates/login.html','_self')
                            });
					});
</script>

 
</body>
</html>